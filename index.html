<script>
document.addEventListener("DOMContentLoaded", () => {
  const sidebar = document.getElementById("sidebar");
  const main = document.getElementById("main");

  fetch("study_log.json")
    .then(res => res.json())
    .then(studyData => {
      studyData.forEach(dayEntry => {
        // Create main entry
        const dayDiv = document.createElement("div");
        dayDiv.className = "entry";
        dayDiv.id = "day-" + dayEntry.day;

        // Topics HTML
        const topicsHtml = dayEntry.topics.map(t => `<li>${t}</li>`).join("");

        // Flashcards HTML (only if any)
        let flashcardsHtml = "";
        if (Array.isArray(dayEntry.flashcards) && dayEntry.flashcards.length > 0) {
          flashcardsHtml = "<h3>Flashcards:</h3><ul>";
          dayEntry.flashcards.forEach(fc => {
            flashcardsHtml += `<li><b>${fc[0]}</b>: ${fc[1]}</li>`;
          });
          flashcardsHtml += "</ul>";
        }

        // Insert HTML
        dayDiv.innerHTML = `<h2>Day ${dayEntry.day} [${dayEntry.date}]</h2>
                            <ul>${topicsHtml}</ul>
                            ${flashcardsHtml}`;
        main.appendChild(dayDiv);

        // Sidebar link
        const sideLink = document.createElement("div");
        sideLink.className = "sidebar-day";
        sideLink.textContent = "Day " + dayEntry.day;
        sideLink.addEventListener("click", () => {
          document.getElementById("day-" + dayEntry.day).scrollIntoView({ behavior: "smooth" });
        });
        sidebar.appendChild(sideLink);
      });
    })
    .catch(err => console.error("Failed to load study log JSON:", err));
});
</script>
